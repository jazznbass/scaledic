---
title: "Building a dictionary file"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Building a dictionary file}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup, include = FALSE}
library(knitr)
library(dplyr)
library(tibble)
library(scaledic)
```

## What is dictionary file

When you do questionnaire based research (and you are working in R) you usually create a *data.frame* with a column (variable) for every item of that questionnaire and a row for every person who participated. You can only store limited additional information on each item of that questionnaire within a `data.frame` (or a `tibble`). What you can do is to a) give a variable name, and b) define a variable as a factor with corresponding levels.

But basically that's it. You can not, at least not conveniently, include a longer label for each item, the name of a scale this item belongs to, information on reverse coding etc.

I call the collection of these additional information on items an *item dictionary*. A dictionary contains a short label, a longer description, scale affiliation, and more for each item. It is a table with one row per item and a column for each additional information on those items.   

Here is a minimal example with a dictionary file including item_name and item_label:

```{r minimal dic file}

dic <- data.frame(
  item_name = c("mpg", "cyl", "disp", "hp", "drat", "wt", "qsec", "vs", "am", 
"gear", "carb"),
  item_label = c("Miles per Galon", "Cylinders", "Displacement", "Horsepower", "Rear axle ration", "Weight", "1/4 miles time", "Engine", "Transmission", "Gears", "Carburetors")
)

dat <- apply_dic(mtcars, dic)

dat %>% 
  rename_items() %>% 
  descriptives() %>% kable()

```

```{r example}

n <- 6
set.seed(1234)
dat <- data.frame(
  gen = sample(sample(c("m", "f", "d"), n, replace = TRUE)),
  age = sample(18:55, n, replace = TRUE),
  hon_1 = sample(1:5, n, replace = TRUE),
  hon_2 = sample(1:5, n, replace = TRUE),
  hon_3 = sample(1:5, n, replace = TRUE)
)

dic <- data.frame(
  item_name = c("gen", "age", "hon_1", "hon_2", "hon_3"),
  item_label = c("What is your gender?", "What is your age?", "Do you lie?", "Are you honest?", "Is honesty important to you?"),
  scale = c("demo", "demo", "hon", "hon", "hon"),
  scale_label = c("Demographic", "Demographic", "Honesty", "Honesty", "Honesty"),
  values = c("", "18:99", "1:5", "1:5", "1:5"),
  value_labels = c("m = male; f = female; ka = keine Angabe", NA,
                   rep("1 = low; 2; 3; 4; 5 = high", 3)),
  type = c("factor", "float", "integer", "integer", "integer"),
  weight = 1,
  missing = c(rep("-99", 5))
)

dat <- apply_dic(dat, dic)
dat$gen

check_values(dat)

```


```{r}
n <- 20
n_var <- 10
dat <- matrix(sample(1:5, n * n_var, replace = TRUE), ncol = n_var)
dat <- as.data.frame(dat)
names(dat) <- LETTERS[1:n_var]

dat$text <- sample(c("m", "f", "ka"), n, replace = TRUE)

dic <- data.frame(
  item_name = names(dat),
  item_label = c(paste("Item", LETTERS[1:n_var]), "gender"),
  scale = c(rep("letters", n_var), "Misc"),
  scale_label = c(rep("Letter Values", n_var), "Miscellaneous"),
  values = c(rep("1:5", n_var), "'male', 'female'"),
  value_labels = c(
    rep("1 = low; 2; 3; 4; 5 = high", n_var), "m = male; f = female; ka = keine Angabe"),
  type = c(rep("integer", n_var), "factor"),
  weight = 1,
  missing = c(rep("-999", n_var), "'keine Angabe'")
)

dat <- apply_dic(dat, dic)
dat <- check_values(dat, report = TRUE)
replace_missing(dat)

dat[1]
dat[[11]]

```



